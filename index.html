<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>VR Food Menu</title>

<!-- DO NOT CHANGE -->
<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{ box-sizing:border-box; }

body{
  margin:0;
  overflow:hidden;
  font-family:Inter, Arial, sans-serif;
  background:#000;
  color:white;
}

/* ---------- UI ---------- */
#info{
  position:absolute;
  top:16px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(20,20,24,.9);
  padding:10px 18px;
  border-radius:14px;
  font-size:15px;
  font-weight:600;
  z-index:5;
}

.btn{
  position:absolute;
  bottom:18px;
  padding:12px 18px;
  background:rgba(30,30,35,.9);
  border:1px solid rgba(255,255,255,.12);
  color:white;
  border-radius:14px;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  z-index:5;
}

#left{ left:14px; }
#right{ right:14px; }
#rate{
  left:50%;
  transform:translateX(-50%);
}

#ratingMenu{
  position:absolute;
  bottom:74px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(20,20,24,.92);
  padding:10px 16px;
  border-radius:16px;
  display:none;
  z-index:5;
}

.star{
  font-size:26px;
  cursor:pointer;
  color:rgba(255,255,255,.25);
}
.star.active{ color:#FFD54F; }

#loading{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#000;
  font-size:18px;
  font-weight:600;
  z-index:10;
}

/* allow UI clicks */
a-scene{ pointer-events:none; }
#info,.btn,#ratingMenu,.star{ pointer-events:auto; }
</style>
</head>

<body>

<div id="info"></div>
<div id="loading">Loading model…</div>

<button id="left" class="btn">◀</button>
<button id="rate" class="btn">Rate</button>
<button id="right" class="btn">▶</button>

<div id="ratingMenu">
  <span class="star" data-s="1">★</span>
  <span class="star" data-s="2">★</span>
  <span class="star" data-s="3">★</span>
  <span class="star" data-s="4">★</span>
  <span class="star" data-s="5">★</span>
</div>

<!-- ================= VR SCENE ================= -->
<a-scene
  embedded
  vr-mode-ui="enabled:true"
  renderer="antialias:true"
  background="color:#050507">

  <!-- Camera -->
  <a-entity camera look-controls position="0 1.6 0"></a-entity>

  <!-- Lights -->
  <a-entity light="type:ambient; intensity:0.9"></a-entity>
  <a-entity light="type:directional; intensity:0.6" position="1 2 1"></a-entity>

  <!-- Environment -->
  <a-plane rotation="-90 0 0" width="20" height="20" color="#07070a"></a-plane>

  <!-- Model Holder -->
  <a-entity id="holder" position="0 1.4 -3"></a-entity>

</a-scene>

<script>
const foods=[
 {model:"models/burger/scene.gltf",name:"Burger",price:"₹149",scale:.4},
 {model:"models/pizza/scene.gltf",name:"Pizza",price:"₹299",scale:2},
 {model:"models/fries/scene.gltf",name:"Fries",price:"₹99",scale:.5},
 {model:"models/samosa/scene.gltf",name:"Samosa",price:"₹39",scale:.5}
];

const holder=document.getElementById("holder");
const info=document.getElementById("info");
const loading=document.getElementById("loading");
const ratingMenu=document.getElementById("ratingMenu");

let index=0, rating=0, yaw=0, scale=foods[0].scale;
let autoRotate=true;

const model=document.createElement("a-entity");
holder.appendChild(model);

/* ---------- Load ---------- */
function loadFood(i){
 loading.style.display="flex";
 model.setAttribute("gltf-model",foods[i].model);
 scale=foods[i].scale;
 model.object3D.scale.set(scale,scale,scale);
 yaw=0;
 info.textContent=`${foods[i].name} • ${foods[i].price}`;
 rating=0;
 updateStars();
}

model.addEventListener("model-loaded",()=>{
 loading.style.display="none";
});

loadFood(0);

/* ---------- UI ---------- */
left.onclick=()=>{ index=(index+foods.length-1)%foods.length; loadFood(index); }
right.onclick=()=>{ index=(index+1)%foods.length; loadFood(index); }

rate.onclick=()=>{
 ratingMenu.style.display =
 ratingMenu.style.display==="block"?"none":"block";
};

function updateStars(){
 document.querySelectorAll(".star").forEach(s=>{
  s.classList.toggle("active",s.dataset.s<=rating);
 });
}

document.querySelectorAll(".star").forEach(s=>{
 s.onclick=()=>{
  rating=s.dataset.s;
  updateStars();
 };
});

/* ---------- Touch Rotate ---------- */
let dragging=false,lx=0;

document.addEventListener("touchstart",e=>{
 if(e.touches.length===1){
  dragging=true;
  lx=e.touches[0].clientX;
  autoRotate=false;
 }
});
document.addEventListener("touchmove",e=>{
 if(dragging){
  yaw+=(e.touches[0].clientX-lx)*0.01;
  lx=e.touches[0].clientX;
  model.object3D.rotation.y=yaw;
 }
});
document.addEventListener("touchend",()=>{
 dragging=false;
 setTimeout(()=>autoRotate=true,1500);
});

/* ---------- Auto Rotate ---------- */
AFRAME.registerComponent("spin",{tick:()=>{
 if(autoRotate){
  yaw+=0.002;
  model.object3D.rotation.y=yaw;
 }
}});
model.setAttribute("spin","");
</script>

</body>
</html>
